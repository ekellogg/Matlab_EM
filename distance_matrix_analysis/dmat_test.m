apo_lst = { ...
'lowest_energy.AB.pdb',...
'inp.t2.r0.2_0028.pdb.AB.pdb',...
'inp.t2.r0.2_0169.pdb.AB.pdb',...
'inp.t2.r0.2_0034.pdb.AB.pdb',...
'inp.t2.r0.2_0201.pdb.AB.pdb',...
'inp.t2.r0.2_0044.pdb.AB.pdb',...
'inp.t2.r0.2_0210.pdb.AB.pdb',...
'inp.t2.r0.2_0054.pdb.AB.pdb',...
'inp.t2.r0.2_0212.pdb.AB.pdb',...
'inp.t2.r0.2_0154.pdb.AB.pdb',...
'inp.t2.r0.2_0156.pdb.AB.pdb',...
};
apo_pdbs = {};

for(i = 1:length(apo_lst))
    apo_pdbs{i} = readPDBnoH(apo_lst{i});
end
nat = length(apo_pdbs{1}.X);
npdb = length(apo_pdbs);
apo_dmat = zeros(nat,nat,npdb);
for(i = 1:length(apo_pdbs))
   apo_dmat(:,:,i) = distance_matrix(apo_pdbs{i}); 
end

pel_lst = { ...
    '../pel/lowest_energy.AB.pdb',...
    '../pel/inp.t2.r0.2_0003.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0200.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0041.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0297.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0096.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0311.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0178.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0321.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0181.pdb.AB.pdb',...
    '../pel/inp.t2.r0.2_0190.pdb.AB.pdb',...
}
pel_pdbs = {};
for(i = 1:length(pel_lst))
    pel_pdbs{i} = readPDBnoH(pel_lst{i});
end


nat = length(pel_pdbs{1}.X);
npdb = length(pel_pdbs);
pel_dmat = zeros(nat,nat,npdb);
for(i = 1:length(pel_pdbs))
   pel_dmat(:,:,i) = distance_matrix(pel_pdbs{i}); 
end

covmat = cov((apo_dmat(:,:,1)-pel_dmat(:,:,1)));
t = covmat;
t(find(t > 0.5)) = 5;
t(find(t < 0.5)) = 0;
imagesc(t*100)


